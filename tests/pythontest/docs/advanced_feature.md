# 进阶使用

## shape泛化机

### 规则说明

- shape可填写`占位符`，以进行验收标准测试。编写规则如下：
- 占位符遵循大多数编程语言中的变量名称原则，即非数字开头的大小写字母加数字加`_`的组合。
- 同时，也可以输入`占位符表达式`，完成更复杂的测试。
- 表达式支持并只建议使用以下运算符：`+ - * % ** //`
- 生成泛化shape时，会根据输入输出shape中的所有不同维度表达式中的占位符进行全排列。
- 当使用字母+符号+数字组合时，将会在生成占位符全排列后，用这个表达式进行一次计算，计算结果为最终shape中的dim。

### 示例

- 例1：InShape为`X,Y`，OutShape为`X,1`，泛化数组为`[2,4]`

```python
(2,2);(2,1)
(2,4);(2,1)
(4,2);(4,1)
(4,4);(4,1)
```

- 例2：InShape为`X*2,3`，OutShape为`X/2,3`，泛化数组为`[2,4,6]`

```python
(4,3);(1,3)
(8,3);(2,3)
(12,3);(3,3)
```

- 例3：InShape为`X,3;Y,3;Z;3`，OutShape为`X+Y+Z,3`，泛化数组为`[2]`

```python
(2,3) (2,3) (2,3);(6,3)
```

## 特殊生成器

numpy/torch中有许多方便的tensor生成工具，DataGenerate字段中，可以编写函数调用式语句，以调用这些丰富的生成规则。

例：均匀分布：`uniform(low=-5,high=5)`

系统将自动传入shape并将结果转换成torch.Tensor。

1. 你必须使用kwargs传入参数。
2. 系统将从torch、numpy.random、numpy中寻找对应函数。
3. 有些数据生成函数不与shape相关；有些数据生成函数以size接收shape，而有些以shape接收shape，这些情况已经考虑到。

## 错误拦截
算子存在各种约束，约束相关的代码在 host 侧运行。为了检查这些拦截是否生效，可以使用错误拦截功能。
